{% extends "base.html" %}
{% block content %}
<section class="worlds-grid">
  <div class="ninebox u-box world-panel">
    <div class="nf tl"></div>
    <div class="nf t"></div>
    <div class="nf tr"></div>
    <div class="nf l"></div>
    <div class="nf c"></div>
    <div class="nf r"></div>
    <div class="nf bl"></div>
    <div class="nf b"></div>
    <div class="nf br"></div>
    <div class="nine-content u-box-content">
      <div class="panel-heading">
        <div>
          <p class="panel-overline">World Directory</p>
          <h2 class="panel-title">World Roster</h2>
        </div>
        <a href="{{ url_for('legacy_start') }}" class="text-xs uppercase tracking-wide text-slate-400 hover:text-white">Legacy setup</a>
      </div>
      <p class="panel-subtle">Select an existing setting or spin up a custom one.</p>
      <div class="world-list u-scroll scroll-fade">
        {% for world in worlds %}
        <a href="{{ url_for('landing', world=world.slug) }}" class="world-entry {% if selected and selected.slug==world.slug %}is-active{% endif %}">
          <div class="world-entry-title">{{ world.title }}</div>
          <p class="world-entry-subtitle">
            {% if world.subtitle %}
            {{ world.subtitle }}
            {% elif world.is_virtual %}
            Craft lore, acts, factions, and bespoke rosters.
            {% else %}
            Configure blueprint + roster.
            {% endif %}
          </p>
        </a>
        {% endfor %}
      </div>
    </div>
  </div>

  <div class="ninebox u-box world-panel">
    <div class="nf tl"></div>
    <div class="nf t"></div>
    <div class="nf tr"></div>
    <div class="nf l"></div>
    <div class="nf c"></div>
    <div class="nf r"></div>
    <div class="nf bl"></div>
    <div class="nf b"></div>
    <div class="nf br"></div>
    <div class="nine-content u-box-content">
      <div class="panel-heading">
        <div>
          <p class="panel-overline">Preview</p>
          <h2 class="panel-title">{{ selected.title if selected else 'World Preview' }}</h2>
        </div>
      </div>
      {% if selected %}
      <div class="world-preview">
        <div class="world-portrait-frame">
          <img src="{{ selected.portrait_url }}" alt="{{ selected.title }}" class="world-portrait" />
        </div>
        <p class="world-preview-copy">{{ selected.subtitle or 'Bring this world to life by finalising the blueprint.' }}</p>
      </div>
      <form method="post" action="{{ url_for('select_world', slug=selected.slug) }}" class="mt-6">
        <button class="u-button w-full" {% if selected.is_virtual %}disabled title="World creation UI coming soon"{% endif %}>Use World</button>
      </form>
      {% else %}
      <p class="text-sm text-slate-400">No saved worlds yet. Create one in the desktop client or via the upcoming builder.</p>
      {% endif %}
    </div>
  </div>

  <div class="ninebox u-box world-panel">
    <div class="nf tl"></div>
    <div class="nf t"></div>
    <div class="nf tr"></div>
    <div class="nf l"></div>
    <div class="nf c"></div>
    <div class="nf r"></div>
    <div class="nf bl"></div>
    <div class="nf b"></div>
    <div class="nf br"></div>
    <div class="nine-content u-box-content">
      <div class="panel-heading">
        <div>
          <p class="panel-overline">Blueprint</p>
          <h2 class="panel-title">World Brief</h2>
        </div>
      </div>
      {% if selected %}
      <div class="world-blueprint u-scroll scroll-fade">
        {% if selected.is_virtual %}
        <p class="text-sm text-slate-300 leading-relaxed">You're about to craft a brand new setting. The upcoming builder will capture lore bibles, act pacing, and roster choices. For now, continue via the legacy launcher if you need to spin up a bespoke run immediately.</p>
        {% else %}
        <dl class="blueprint-grid">
          <div>
            <dt>World Name</dt>
            <dd>{{ selected.title }}</dd>
          </div>
          <div>
            <dt>Acts</dt>
            <dd>{{ selected.acts }}</dd>
          </div>
          <div>
            <dt>Turns / Act</dt>
            <dd>{{ selected.turns_per_act }}</dd>
          </div>
          <div>
            <dt>Pressure</dt>
            <dd>{{ selected.pressure or 'TBD' }}</dd>
          </div>
        </dl>
        <div class="blueprint-section">
          <p class="label">Campaign Goal</p>
          <p class="body">{{ selected.subtitle }}</p>
        </div>
        <div class="blueprint-section">
          <p class="label">Lore Bible</p>
          <pre class="body prose-block">{{ selected.lore }}</pre>
        </div>
        {% endif %}
      </div>
      {% else %}
      <p class="text-sm text-slate-400">Select a world to review its blueprint.</p>
      {% endif %}
    </div>
  </div>
</section>
{% endblock %}
